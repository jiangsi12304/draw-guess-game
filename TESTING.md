# 🧪 测试指南

本文档提供详细的功能测试步骤和验证清单。

## 环境准备

### 本地测试环境

**需求：**
- Node.js 18+
- npm 或 yarn
- 两个或多个浏览器实例（标签页或设备）
- Firebase 项目和凭证

**设置：**

```bash
# 1. 安装依赖
npm install

# 2. 创建 .env.local（使用你的 Firebase 凭证）
cp .env.example .env.local
# 编辑 .env.local 并填入 Firebase 信息

# 3. 启动开发服务器
npm run dev
```

## 测试场景

### 1️⃣ 用户设置（User Setup）

**步骤：**
1. 打开 http://localhost:5173
2. 输入昵称（例："玩家1"）
3. 选择头像
4. 点击"确认"

**预期结果：**
- ✅ 昵称和头像已保存
- ✅ 进入主菜单
- ✅ 菜单显示正确的昵称和头像

**检查点：**
- [ ] 昵称输入有效
- [ ] 头像选择工作正常
- [ ] 点击"确认"后进入菜单

---

### 2️⃣ 创建房间（Create Room）

**步骤：**
1. 在菜单点击"创建房间"
2. 输入房间名称（例："朋友聚会"）
3. 设置游戏轮数（例：5）
4. 设置每轮时间（例：60秒）
5. 点击"创建房间"

**预期结果：**
- ✅ 房间创建成功
- ✅ 进入大厅（Lobby）
- ✅ 显示房间邀请码（6位字母）
- ✅ 显示当前玩家信息

**检查点：**
- [ ] 房间名称保存正确
- [ ] 邀请码已生成
- [ ] 邀请码复制功能工作
- [ ] 房主身份正确显示

---

### 3️⃣ 加入房间（Join Room）

**步骤（新标签页/设备）：**
1. 打开 http://localhost:5173
2. 输入不同的昵称（例："玩家2"）
3. 选择不同的头像
4. 点击"加入房间"
5. 输入从创建者获得的邀请码
6. 点击"加入"

**预期结果：**
- ✅ 成功加入房间
- ✅ 进入同一个大厅
- ✅ 看到房主和其他玩家

**检查点：**
- [ ] 邀请码验证工作正常
- [ ] 房间人数计数正确
- [ ] 所有玩家都显示在列表中
- [ ] 玩家信息实时同步

---

### 4️⃣ 实时同步测试（Real-time Sync）

**步骤：**
1. 保持两个标签页/设备都在大厅
2. 在一个标签页改变用户准备状态
3. 观察另一个标签页

**预期结果：**
- ✅ 状态在两个客户端实时同步
- ✅ 延迟 < 1 秒

**检查点：**
- [ ] 玩家加入实时更新
- [ ] 玩家离开实时更新
- [ ] 玩家准备状态实时更新

---

### 5️⃣ 开始游戏（Start Game）

**步骤：**
1. 房主点击"开始游戏"按钮
2. 观察所有客户端

**预期结果：**
- ✅ 进入游戏画面
- ✅ 显示绘画者和猜测者
- ✅ 计时器开始倒计时
- ✅ 绘画画布可用

**检查点：**
- [ ] 游戏状态正确转换
- [ ] 计时器准确计时
- [ ] 每个玩家看到正确的角色信息

---

### 6️⃣ 绘画功能（Drawing）

**步骤（绘画者）：**
1. 在画布上自由绘画
2. 尝试不同的绘画工具：
   - 普通笔
   - 橡皮擦
   - 清空画布
   - 撤销

**预期结果：**
- ✅ 画笔输入正常
- ✅ 线条顺滑
- ✅ 橡皮擦有效
- ✅ 清空和撤销工作正常

**检查点：**
- [ ] 绘画流畅性（60 FPS）
- [ ] 笔刷大小合理
- [ ] 工具切换迅速
- [ ] 画布性能良好

---

### 7️⃣ 绘画同步（Drawing Sync）

**步骤：**
1. 绘画者在一个标签页绘画
2. 观察猜测者的标签页

**预期结果：**
- ✅ 绘画实时显示在所有客户端
- ✅ 笔画线条一致
- ✅ 没有明显延迟

**检查点：**
- [ ] 同步延迟 < 500ms
- [ ] 笔画完整性
- [ ] 多个客户端同步准确
- [ ] 没有丢失笔画

---

### 8️⃣ 聊天功能（Chat）

**步骤（猜测者）：**
1. 在聊天框输入消息
2. 尝试不同的猜测：
   - 错误的词语
   - 正确的词语
3. 按 Enter 发送

**预期结果：**
- ✅ 消息实时出现在所有客户端
- ✅ 正确的猜测显示为绿色
- ✅ 错误的猜测显示为灰色
- ✅ 消息顺序正确

**检查点：**
- [ ] 聊天消息同步
- [ ] 正确答案检测工作
- [ ] 消息时间戳正确
- [ ] 用户名正确显示

---

### 9️⃣ 计分系统（Scoring）

**步骤：**
1. 观察计分板
2. 有玩家猜对时，观察分数更新

**预期结果：**
- ✅ 猜对时加 50 分
- ✅ 分数实时更新
- ✅ 排名正确显示
- ✅ 最终分数正确

**检查点：**
- [ ] 初始分数为 0
- [ ] 猜对加分准确
- [ ] 分数实时同步
- [ ] 排行榜排序正确

---

### 🔟 游戏流程（Game Flow）

**步骤：**
1. 完整进行一轮游戏
2. 观察轮次转换
3. 绘画者轮流切换

**预期结果：**
- ✅ 轮次正确计数
- ✅ 绘画者按顺序轮流
- ✅ 计时器准确
- ✅ 轮次间无卡顿

**检查点：**
- [ ] 轮数计数准确
- [ ] 绘画者顺序正确
- [ ] 时间倒计时准确
- [ ] 轮次转换流畅

---

## 跨设备测试

### 同局域网测试

**环境：**
- 同一 WiFi 网络
- 两台不同的设备

**步骤：**
1. 在主电脑运行 `npm run dev`
2. 查看你的 IP: `ipconfig` (Windows) / `ifconfig` (Mac/Linux)
3. 在另一台设备访问 `http://你的IP:5173`
4. 进行房间创建和加入测试

**检查点：**
- [ ] 设备之间可以通信
- [ ] 房间同步正常
- [ ] 绘画实时显示
- [ ] 聊天实时更新

---

## 构建测试

### 生产构建验证

```bash
# 构建项目
npm run build

# 预览生产版本
npm run preview
```

**检查点：**
- [ ] 构建无错误
- [ ] 构建输出大小合理（< 500KB）
- [ ] 预览版本功能完整
- [ ] 没有控制台错误

---

## 性能测试

### 加载时间

**测试方法：**
1. 打开浏览器开发工具（F12）
2. 切换到 Network 标签
3. 刷新页面
4. 记录加载时间

**目标：**
- ✅ 首屏加载 < 3 秒
- ✅ 交互就绪 < 5 秒

### 内存使用

**测试方法：**
1. 打开 Performance 标签
2. 运行内存分析
3. 进行 10 分钟游戏
4. 观察内存趋势

**目标：**
- ✅ 初始内存 < 50MB
- ✅ 长时间游戏无明显增长

### 网络使用

**测试方法：**
1. 使用 Network 标签
2. 过滤 WebSocket 连接
3. 观察 Firebase 消息频率

**目标：**
- ✅ 空闲时无消息
- ✅ 游戏中消息频率合理

---

## 浏览器兼容性测试

**支持的浏览器：**
- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+
- ✅ Chrome Mobile
- ✅ Safari iOS

**测试步骤：**
1. 在各浏览器测试基本功能
2. 测试响应式设计
3. 检查控制台错误

---

## 错误场景测试

### 网络断开

**步骤：**
1. 启动游戏
2. 关闭 WiFi 或网络
3. 观察应用行为

**预期：**
- 应该显示错误信息
- 重新连接后应恢复

### Firebase 配置错误

**步骤：**
1. 使用错误的 Firebase 凭证
2. 启动应用

**预期：**
- 应该显示配置错误
- 提示用户检查 .env.local

### 房间满员

**步骤：**
1. 创建房间
2. 加入 6 个玩家
3. 尝试再加入一个

**预期：**
- 第 7 个玩家应被拒绝
- 显示"房间已满"错误

---

## 测试清单

### 功能完整性
- [ ] 用户设置正常
- [ ] 房间创建/加入正常
- [ ] 实时同步工作
- [ ] 绘画和聊天功能完整
- [ ] 计分系统准确
- [ ] 游戏流程完整

### 性能
- [ ] 加载速度 < 3 秒
- [ ] 帧率稳定 ≥ 60 FPS
- [ ] 内存占用合理
- [ ] 网络使用高效

### 兼容性
- [ ] 桌面浏览器
- [ ] 移动浏览器
- [ ] 不同操作系统
- [ ] 不同屏幕尺寸

### 错误处理
- [ ] 网络错误提示
- [ ] 配置错误提示
- [ ] 房间错误处理
- [ ] 优雅降级

---

## 报告问题

如果发现 Bug，请创建 Issue 并包含：

1. **环境信息**
   - 浏览器版本
   - 操作系统
   - Node.js 版本

2. **问题描述**
   - 具体发生了什么
   - 预期应该发生什么

3. **复现步骤**
   - 详细的步骤列表
   - 截图或视频

4. **错误日志**
   - 浏览器控制台错误
   - Firebase 错误信息

---

**祝你测试愉快！🧪**
